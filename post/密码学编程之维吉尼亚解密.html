

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="c1ongyan">
  <meta name="keywords" content="">
  
    <meta name="description" content="密码学编程之维吉尼亚解密1.什么是维吉尼亚密码它是典型的多表代换密码，它的加密过程可以通过查表来表示，密文字母为横列，密钥字母为纵列（可以互换），对应得到的字母为加密后的密文，相当于每个字母都选择了一个偏移值来进行凯撒加密，但为了增强密码的可用性与简洁性，维吉尼亚的密钥采取周期式的密钥，即每隔一个周期用同一张表（即同一偏移）来加密。  示例： 密钥为：encryption 明文为：publicke">
<meta property="og:type" content="article">
<meta property="og:title" content="密码学编程之维吉尼亚解密">
<meta property="og:url" content="http://example.com/post/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%BC%96%E7%A8%8B%E4%B9%8B%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E8%A7%A3%E5%AF%86.html">
<meta property="og:site_name" content="c1ongyan">
<meta property="og:description" content="密码学编程之维吉尼亚解密1.什么是维吉尼亚密码它是典型的多表代换密码，它的加密过程可以通过查表来表示，密文字母为横列，密钥字母为纵列（可以互换），对应得到的字母为加密后的密文，相当于每个字母都选择了一个偏移值来进行凯撒加密，但为了增强密码的可用性与简洁性，维吉尼亚的密钥采取周期式的密钥，即每隔一个周期用同一张表（即同一偏移）来加密。  示例： 密钥为：encryption 明文为：publicke">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021509869.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021519981.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021638455.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021640346.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021656478.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210031643690.png">
<meta property="article:published_time" content="2022-10-02T07:03:43.000Z">
<meta property="article:modified_time" content="2022-10-09T08:53:55.345Z">
<meta property="article:author" content="c1ongyan">
<meta property="article:tag" content="密码学">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021509869.png">
  
  
  
  <title>密码学编程之维吉尼亚解密 - c1ongyan</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="密码学编程之维吉尼亚解密"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-10-02 15:03" pubdate>
          October 2, 2022 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9.9k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          83 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">密码学编程之维吉尼亚解密</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="密码学编程之维吉尼亚解密"><a href="#密码学编程之维吉尼亚解密" class="headerlink" title="密码学编程之维吉尼亚解密"></a>密码学编程之维吉尼亚解密</h1><h2 id="1-什么是维吉尼亚密码"><a href="#1-什么是维吉尼亚密码" class="headerlink" title="1.什么是维吉尼亚密码"></a>1.什么是维吉尼亚密码</h2><p>它是典型的多表代换密码，它的加密过程可以通过查表来表示，密文字母为横列，密钥字母为纵列（可以互换），对应得到的字母为加密后的密文，相当于每个字母都选择了一个偏移值来进行凯撒加密，但为了增强密码的可用性与简洁性，维吉尼亚的密钥采取周期式的密钥，即每隔一个周期用同一张表（即同一偏移）来加密。</p>
<p><img src="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021509869.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>示例：</p>
<p>密钥为：encryption</p>
<p>明文为：publickeydistribution</p>
<p><img src="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021519981.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<h2 id="2-维吉尼亚解密"><a href="#2-维吉尼亚解密" class="headerlink" title="2.维吉尼亚解密"></a>2.维吉尼亚解密</h2><h3 id="2-1已知密钥的维吉尼亚解密"><a href="#2-1已知密钥的维吉尼亚解密" class="headerlink" title="2.1已知密钥的维吉尼亚解密"></a>2.1已知密钥的维吉尼亚解密</h3><p>思路：做加密的逆过程即可。加密是按照密钥进行凯撒加密，解密就是按照密钥进行凯撒解密。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> wordninja <span class="hljs-comment">#wordninja是分词工具</span><br><br>Letters=<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">key,message</span>):<br><br>	result=<span class="hljs-string">''</span><br>	l=<span class="hljs-built_in">len</span>(key)<br>	j=<span class="hljs-number">0</span><br><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> message:<br>		index=(Letters.find(i)-Letters.find(key[j]))%<span class="hljs-number">26</span><br>		j=(j+<span class="hljs-number">1</span>)%l<br>		result=result+Letters[index]<br><br>	text=<span class="hljs-string">' '</span>.join(wordninja.split(result)) <span class="hljs-comment">#对解密结果按英文分词，增加可读性</span><br><br>	<span class="hljs-keyword">return</span> text<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	message=<span class="hljs-string">'krkpewxvftksopztecxvbuhfvycgxouflihoffptrcwffwhkcevxhiuzfposdvccyctpmjtbfymllctiwxtacsmjmoncwdnawjrwtjgjsuystvbxgvcmgczbqecllttfkjlacpfttjgeegtbvkfpmhjzqaxhvvpgxoeychrcwumchhyigixhqdciawunmjerefkekcozqttznfdjlopuyqhjgrjawcpfrgxhwiljgrgiycrqkiajfgvrlrxgkkghdbqnliaovzrltgafslacjvjexrwjrdzsvruprttfkwxfgrlstznnmjerdvjdlhkwwdngjfsawgjfunhitjcaykgrptzicibtwrcpycwbkxfibrqemivotvwdnotvldmvgicshbqkztmfqlzaxrqekntqefscmbqkfxguyzjaaorgccmcovrwxbckgdgonrqhxadcclbznjfdpzgegtgqawygxkgcjiasofqiecxvbdyageztjikvrxymqlapghcbcrtfgfdnhitjcaytqiknlsnwgrtbpfrlkwvvycraqicqnhpfrwbbizliasyfpawqqljslhqgktmccumgxmqlsemcvycsxovy'</span><br>	key=<span class="hljs-string">'CRYPTO'</span><br>	<span class="hljs-built_in">print</span>(decrypt(key,message.upper()))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>	main()<br></code></pre></td></tr></table></figure>
<h3 id="2-2唯密文的维吉尼亚解密"><a href="#2-2唯密文的维吉尼亚解密" class="headerlink" title="2.2唯密文的维吉尼亚解密"></a>2.2唯密文的维吉尼亚解密</h3><h4 id="1-利用重合指数-重合互指数解密"><a href="#1-利用重合指数-重合互指数解密" class="headerlink" title="1.利用重合指数+重合互指数解密"></a>1.利用重合指数+重合互指数解密</h4><p>此种方法对于唯密文的维吉尼亚解密是基于语言的统计规律，所以当密文很短是是无法用该方法解密的，对长密文比较适用</p>
<p>思路：</p>
<p>1.根据kasiski或者重合指数计算出密钥长度</p>
<p>Kasiski测验法基本原理：用给定长度为k的密钥周期性地对明文加密，则但明文中有两个相同的字母，且对应被加密后的字母也相同时，这两个字母的间距是k的倍数。找到密文中相同字母间隔的最大公因数，很有可能是密钥长度。</p>
<p>重合指数法：对单表替换而已，并不会改变字符串的统计特性（比如，某个英语字母出现的频率），故其重合指数应该约等于0.065。可以爆破密钥长度，根据密钥长度将同一密钥字母加密的字母放在一个分组内，每个分组都相当于被单表替换，都应满足重合指数应该约等于0.065。</p>
<p>重合指数:两个随机字母相同的概率（即在一字符串中随机取出两个字母为a的概率+同为b的概率+…）</p>
<p>​                                                            <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.777ex;" xmlns="http://www.w3.org/2000/svg" width="13.553ex" height="2.664ex" role="img" focusable="false" viewBox="0 -833.9 5990.4 1177.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="mi" transform="translate(504,0)"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1541.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munderover" transform="translate(2597.6,0)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="msubsup" transform="translate(5050.9,0)"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mn" transform="translate(536,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(536,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container></p>
<p>（pi为字母i出现频率）</p>
<p>重合指数无偏估计值(更准确，用此来计算):</p>
<p>​                                                            <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.238ex;" xmlns="http://www.w3.org/2000/svg" width="19.072ex" height="3.607ex" role="img" focusable="false" viewBox="0 -1047.1 8429.7 1594.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="msup" transform="translate(504,0)"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="TeXAtom" transform="translate(845.3,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2035" d="M12 501Q12 527 31 542T63 558Q73 560 77 560Q114 560 128 528Q133 518 188 293T244 61Q244 56 223 50T195 43Q192 43 190 45T102 263T14 486Q12 496 12 501Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1871.5,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munderover" transform="translate(2927.3,0)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mfrac" transform="translate(5380.6,0)"><g data-mml-node="mrow" transform="translate(220,516.8) scale(0.707)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(817,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(1206,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(2022.9,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(2800.9,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(3300.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><g data-mml-node="mrow" transform="translate(373.4,-370.3) scale(0.707)"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(600,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(989,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1589,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(2367,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(2867,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><rect width="2809.2" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></p>
<p>（fi为字母i出现次数，n为字符串字符总数）</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCnt</span>(<span class="hljs-params">string</span>):<br><span class="hljs-comment">#统计字符出现的次数</span><br>	LettersZd={<span class="hljs-string">'A'</span>:<span class="hljs-number">0</span>, <span class="hljs-string">'B'</span>:<span class="hljs-number">0</span>, <span class="hljs-string">'C'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'D'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'E'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'F'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'G'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'H'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'I'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'J'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'K'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'L'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'M'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'N'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'O'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'P'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'Q'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'R'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'S'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'T'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'U'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'V'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'W'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'X'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'Y'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'Z'</span>: <span class="hljs-number">0</span>}<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string:<br>		<span class="hljs-keyword">if</span> i  <span class="hljs-keyword">in</span> LettersZd:<br>			LettersZd[i]+=<span class="hljs-number">1</span><br><br>	<span class="hljs-keyword">return</span> LettersZd<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getIC</span>(<span class="hljs-params">Zd</span>):<br><span class="hljs-comment">#计算重合指数</span><br>	fi=<span class="hljs-number">0</span><br>	n=<span class="hljs-number">0</span> <span class="hljs-comment">#总数n</span><br>	<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> Zd:<br>		fi=fi+Zd[k]*(Zd[k]-<span class="hljs-number">1</span>)<br>		n=n+Zd[k]<br><br>	p=fi/(n*(n-<span class="hljs-number">1</span>))<br><br>	<span class="hljs-keyword">return</span> p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getLenKey</span>(<span class="hljs-params">message</span>):<br><span class="hljs-comment">#得到密钥长度</span><br><span class="hljs-comment">#方法：计算子串重合指数</span><br>	cnt=<span class="hljs-number">0</span><br>	pi=<span class="hljs-number">0</span><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(Letters)):<br>		<span class="hljs-comment">#print('key_length=%s'%i)</span><br>		<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,i+<span class="hljs-number">1</span>):<br>			<span class="hljs-built_in">str</span>=message[j::i]<br>			LettersZd=getCnt(<span class="hljs-built_in">str</span>)<br><br>			pi=getIC(LettersZd)<br>			<br>			<span class="hljs-keyword">if</span> pi&gt;<span class="hljs-number">0.055</span> <span class="hljs-keyword">and</span> pi&lt;<span class="hljs-number">0.075</span>:<br>				cnt+=<span class="hljs-number">1</span><br>		<span class="hljs-keyword">if</span> cnt==i:<br>			<span class="hljs-keyword">return</span> i <br>			<span class="hljs-keyword">break</span><br>		cnt=<span class="hljs-number">0</span><br>		pi=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<h4 id="2-根据重合互指数得到密钥"><a href="#2-根据重合互指数得到密钥" class="headerlink" title="2.根据重合互指数得到密钥"></a>2.根据重合互指数得到密钥</h4><p>重合互指数：</p>
<p><img src="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021638455.png" srcset="/img/loading.gif" lazyload alt="image-20221002163842394"></p>
<p>当两个子串的相对位移为0时其值为0.065，不为0则都在0.3~0.4左右，故我们可以把其中一子串设为标准英语，另一子串为根据密钥长度分组后的子串，爆破26种偏移，重合互指数最大的应该是子串相对标准英语的偏移，从而确定对应密钥字母。</p>
<p><img src="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021640346.png" srcset="/img/loading.gif" lazyload alt="image-20221002164000301"></p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMI</span>(<span class="hljs-params">str_1</span>):<br><span class="hljs-comment">#计算子串与标准英语之间的重合互指数</span><br>	Zd_1=[<span class="hljs-number">0.082</span>,<span class="hljs-number">0.015</span>,<span class="hljs-number">0.028</span>,<span class="hljs-number">0.043</span>,<span class="hljs-number">0.127</span>,<span class="hljs-number">0.022</span>,<span class="hljs-number">0.020</span>,<span class="hljs-number">0.061</span>,<span class="hljs-number">0.070</span>,<span class="hljs-number">0.002</span>,<span class="hljs-number">0.008</span>,<span class="hljs-number">0.040</span>,<span class="hljs-number">0.024</span>,<span class="hljs-number">0.067</span>,<span class="hljs-number">0.075</span>,<span class="hljs-number">0.019</span>,<span class="hljs-number">0.001</span>,<span class="hljs-number">0.060</span>,<span class="hljs-number">0.063</span>,<span class="hljs-number">0.091</span>,<span class="hljs-number">0.028</span>,<span class="hljs-number">0.010</span>,<span class="hljs-number">0.023</span>,<span class="hljs-number">0.001</span>,<span class="hljs-number">0.020</span>,<span class="hljs-number">0.001</span>] <span class="hljs-comment">#英语中a,b,c...z的频率</span><br>	Zd_2=getCnt(str_1)<br><br>	matrix_1=np.array(Zd_1)<br>	matrix_2=np.array(<span class="hljs-built_in">list</span>(Zd_2.values()))  <span class="hljs-comment">#转成数组便于计算内积</span><br><br><br>	n2=np.<span class="hljs-built_in">sum</span>(matrix_2)<br>	pi=matrix_2/n2<br><br>	Hp=np.<span class="hljs-built_in">sum</span>(pi*matrix_1)<br><br>	<span class="hljs-keyword">return</span> Hp<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KaiSa</span>(<span class="hljs-params">key,string</span>):<br><span class="hljs-comment">#按需偏移字符串（凯撒加密）</span><br>	result=<span class="hljs-string">''</span><br>	<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> string:<br>		index=Letters.find(s)<br>		result=result+Letters[(index+key)%<span class="hljs-built_in">len</span>(Letters)]<br><br>	<span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getListMI</span>(<span class="hljs-params">num,group</span>):<br><span class="hljs-comment">#求出num号的子串的26种偏移下的重合互指数，并返回改组中最大互指数对应的偏移</span><br>	mm=<span class="hljs-number">0</span><br>	result=[] <span class="hljs-comment">#存放一组重合互指数</span><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(Letters)):<br>		string=KaiSa(i,group[num])<br>		x=getMI(string)<br>		<span class="hljs-comment">#print(x)</span><br>		<span class="hljs-keyword">if</span> x&gt;mm:<br>			mm=x<br>			key=i<br>		result.append(x)<br><br>	<span class="hljs-keyword">return</span> result,key<br><br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getKey</span>(<span class="hljs-params">message</span>):<br><span class="hljs-comment">#破解密钥</span><br><br>	key_len=getLenKey(message)<br><br><br>	group=[] <span class="hljs-comment">#按照密钥长度分组</span><br>	h_key={} <span class="hljs-comment">#存储偏移K</span><br>	MI={} <span class="hljs-comment">#储存偏移值</span><br>	Letter_key=<span class="hljs-string">''</span><span class="hljs-comment">#储存字母加密密钥</span><br><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(key_len):    <span class="hljs-comment">#按照密钥长度分组</span><br>		group.append(message[i::key_len])<br>	<span class="hljs-comment">#print(group)</span><br><br>	<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,key_len):  <span class="hljs-comment">#求出每组的所有重合互指数和最大重合互指数对应的偏移</span><br>		MI[i],h_key[i]=getListMI(i,group)<br><br>	<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(key_len):     <span class="hljs-comment">#根据偏移写出密钥，因为偏移是相对密文的，而密钥则是相对明文的，故要用26-相对密文的偏移</span><br>		m=Letters[<span class="hljs-number">26</span>-h_key[i]]<br>		Letter_key=Letter_key+m<br><br>	<span class="hljs-keyword">return</span> Letter_key<br></code></pre></td></tr></table></figure>
<h4 id="3-已知密钥的维吉尼亚解密"><a href="#3-已知密钥的维吉尼亚解密" class="headerlink" title="3.已知密钥的维吉尼亚解密"></a>3.已知密钥的维吉尼亚解密</h4><p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">key,message</span>):<br><br>	result=<span class="hljs-string">''</span><br>	l=<span class="hljs-built_in">len</span>(key)<br>	j=<span class="hljs-number">0</span><br><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> message:<br>		index=(Letters.find(i)-Letters.find(key[j]))%<span class="hljs-number">26</span><br>		j=(j+<span class="hljs-number">1</span>)%l<br>		result=result+Letters[index]<br><br>	text=<span class="hljs-string">' '</span>.join(wordninja.split(result))  <span class="hljs-comment">#利用wordninja分词工具自动分词，增加明文可读性</span><br><br>	<span class="hljs-keyword">return</span> text<br></code></pre></td></tr></table></figure>
<h4 id="4-完整代码及运行结果示例"><a href="#4-完整代码及运行结果示例" class="headerlink" title="4.完整代码及运行结果示例"></a>4.完整代码及运行结果示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#维吉尼亚解密：不知道密钥情况下分析密钥，求出密文(适合长密文)</span><br><span class="hljs-comment">#思路：1.求出密钥长度：方法可以用kasiski或者重合指数,这里用重合指数法</span><br><span class="hljs-comment">#重合指数法思路：爆破key长度，将一组的子串计算重合指数p^2和(近似)，每一个子串重合指数都在0.065左右的则为真实密钥长度</span><br><span class="hljs-comment">#2.破解密钥：根据重合互指数，爆破相对偏移</span><br><span class="hljs-comment">#3.求解密文:已知密钥求密文</span><br><br><span class="hljs-string">'''</span><br><span class="hljs-string">表达难点：</span><br><span class="hljs-string">子串计算的处理==&gt;直接利用字符串自带的按步长分片</span><br><span class="hljs-string">重合指数的存储判断==&gt;方法一:计算平均值判断</span><br><span class="hljs-string">重合互指数需要将已满足条件的</span><br><span class="hljs-string">如何判断是约等于0.065</span><br><span class="hljs-string">'''</span><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> wordninja<br><br>Letters=<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCnt</span>(<span class="hljs-params">string</span>):<br><span class="hljs-comment">#统计字符出现的频率</span><br>	LettersZd={<span class="hljs-string">'A'</span>:<span class="hljs-number">0</span>, <span class="hljs-string">'B'</span>:<span class="hljs-number">0</span>, <span class="hljs-string">'C'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'D'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'E'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'F'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'G'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'H'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'I'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'J'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'K'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'L'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'M'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'N'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'O'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'P'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'Q'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'R'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'S'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'T'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'U'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'V'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'W'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'X'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'Y'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'Z'</span>: <span class="hljs-number">0</span>}<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string:<br>		<span class="hljs-keyword">if</span> i  <span class="hljs-keyword">in</span> LettersZd:<br>			LettersZd[i]+=<span class="hljs-number">1</span><br><br>	<span class="hljs-keyword">return</span> LettersZd<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getIC</span>(<span class="hljs-params">Zd</span>):<br><span class="hljs-comment">#计算重合指数</span><br>	fi=<span class="hljs-number">0</span><br>	n=<span class="hljs-number">0</span> <span class="hljs-comment">#总数n</span><br>	<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> Zd:<br>		fi=fi+Zd[k]*(Zd[k]-<span class="hljs-number">1</span>)<br>		n=n+Zd[k]<br><br>	p=fi/(n*(n-<span class="hljs-number">1</span>))<br><br>	<span class="hljs-keyword">return</span> p<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getLenKey</span>(<span class="hljs-params">message</span>):<br><span class="hljs-comment">#得到密钥长度</span><br><span class="hljs-comment">#方法：计算子串重合指数</span><br>	cnt=<span class="hljs-number">0</span><br>	pi=<span class="hljs-number">0</span><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(Letters)):<br>		<span class="hljs-comment">#print('key_length=%s'%i)</span><br>		<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,i+<span class="hljs-number">1</span>):<br>			<span class="hljs-built_in">str</span>=message[j::i]<br>			LettersZd=getCnt(<span class="hljs-built_in">str</span>)<br><br>			pi=getIC(LettersZd)<br>			<br>			<span class="hljs-keyword">if</span> pi&gt;<span class="hljs-number">0.055</span> <span class="hljs-keyword">and</span> pi&lt;<span class="hljs-number">0.075</span>:<br>				cnt+=<span class="hljs-number">1</span><br>		<span class="hljs-keyword">if</span> cnt==i:<br>			<span class="hljs-keyword">return</span> i <br>			<span class="hljs-keyword">break</span><br>		cnt=<span class="hljs-number">0</span><br>		pi=<span class="hljs-number">0</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMI</span>(<span class="hljs-params">str_1</span>):<br><span class="hljs-comment">#计算子串与标准英语之间的重合互指数</span><br>	Zd_1=[<span class="hljs-number">0.082</span>,<span class="hljs-number">0.015</span>,<span class="hljs-number">0.028</span>,<span class="hljs-number">0.043</span>,<span class="hljs-number">0.127</span>,<span class="hljs-number">0.022</span>,<span class="hljs-number">0.020</span>,<span class="hljs-number">0.061</span>,<span class="hljs-number">0.070</span>,<span class="hljs-number">0.002</span>,<span class="hljs-number">0.008</span>,<span class="hljs-number">0.040</span>,<span class="hljs-number">0.024</span>,<span class="hljs-number">0.067</span>,<span class="hljs-number">0.075</span>,<span class="hljs-number">0.019</span>,<span class="hljs-number">0.001</span>,<span class="hljs-number">0.060</span>,<span class="hljs-number">0.063</span>,<span class="hljs-number">0.091</span>,<span class="hljs-number">0.028</span>,<span class="hljs-number">0.010</span>,<span class="hljs-number">0.023</span>,<span class="hljs-number">0.001</span>,<span class="hljs-number">0.020</span>,<span class="hljs-number">0.001</span>] <span class="hljs-comment">#英语中a,b,c...z的频率</span><br>	Zd_2=getCnt(str_1)<br><br>	matrix_1=np.array(Zd_1)<br>	matrix_2=np.array(<span class="hljs-built_in">list</span>(Zd_2.values()))  <span class="hljs-comment">#转成数组便于计算内积</span><br><br><br>	n2=np.<span class="hljs-built_in">sum</span>(matrix_2)<br>	pi=matrix_2/n2<br><br>	Hp=np.<span class="hljs-built_in">sum</span>(pi*matrix_1)<br><br>	<span class="hljs-keyword">return</span> Hp<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KaiSa</span>(<span class="hljs-params">key,string</span>):<br><span class="hljs-comment">#按需偏移字符串（凯撒加密）</span><br>	result=<span class="hljs-string">''</span><br>	<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> string:<br>		index=Letters.find(s)<br>		result=result+Letters[(index+key)%<span class="hljs-built_in">len</span>(Letters)]<br><br>	<span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getListMI</span>(<span class="hljs-params">num,group</span>):<br><span class="hljs-comment">#求出num号的子串的26种偏移下的重合互指数，并返回改组中最大互指数对应的偏移</span><br>	mm=<span class="hljs-number">0</span><br>	result=[] <span class="hljs-comment">#存放一组重合互指数</span><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(Letters)):<br>		string=KaiSa(i,group[num])<br>		x=getMI(string)<br>		<span class="hljs-comment">#print(x)</span><br>		<span class="hljs-keyword">if</span> x&gt;mm:<br>			mm=x<br>			key=i<br>		result.append(x)<br><br>	<span class="hljs-keyword">return</span> result,key<br><br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getKey</span>(<span class="hljs-params">message</span>):<br><span class="hljs-comment">#破解密钥</span><br><br>	key_len=getLenKey(message)<br><br><br>	group=[] <span class="hljs-comment">#按照密钥长度分组</span><br>	h_key={} <span class="hljs-comment">#存储偏移K</span><br>	MI={} <span class="hljs-comment">#储存偏移值</span><br>	Letter_key=<span class="hljs-string">''</span><span class="hljs-comment">#储存字母加密密钥</span><br><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(key_len):    <span class="hljs-comment">#按照密钥长度分组</span><br>		group.append(message[i::key_len])<br>	<span class="hljs-comment">#print(group)</span><br><br>	<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,key_len):  <span class="hljs-comment">#求出每组的所有重合互指数和最大重合互指数对应的偏移</span><br>		MI[i],h_key[i]=getListMI(i,group)<br><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(key_len):     <span class="hljs-comment">#根据偏移写出密钥，因为偏移是相对密文的，而密钥则是相对明文的，故要用26-相对密文的偏移</span><br>		m=Letters[(<span class="hljs-number">26</span>-h_key[i])%<span class="hljs-number">26</span>]<br>		Letter_key=Letter_key+m<br><br>	<span class="hljs-keyword">return</span> Letter_key<br>	<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">key,message</span>):<br><br>	result=<span class="hljs-string">''</span><br>	l=<span class="hljs-built_in">len</span>(key)<br>	j=<span class="hljs-number">0</span><br><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> message:<br>		index=(Letters.find(i)-Letters.find(key[j]))%<span class="hljs-number">26</span><br>		j=(j+<span class="hljs-number">1</span>)%l<br>		result=result+Letters[index]<br><br>	text=<span class="hljs-string">' '</span>.join(wordninja.split(result))<br><br>	<span class="hljs-keyword">return</span> text<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	message=<span class="hljs-string">'krkpewxvftksopztecxvbuhfvycgxouflihoffptrcwffwhkcevxhiuzfposdvccyctpmjtbfymllctiwxtacsmjmoncwdnawjrwtjgjsuystvbxgvcmgczbqecllttfkjlacpfttjgeegtbvkfpmhjzqaxhvvpgxoeychrcwumchhyigixhqdciawunmjerefkekcozqttznfdjlopuyqhjgrjawcpfrgxhwiljgrgiycrqkiajfgvrlrxgkkghdbqnliaovzrltgafslacjvjexrwjrdzsvruprttfkwxfgrlstznnmjerdvjdlhkwwdngjfsawgjfunhitjcaykgrptzicibtwrcpycwbkxfibrqemivotvwdnotvldmvgicshbqkztmfqlzaxrqekntqefscmbqkfxguyzjaaorgccmcovrwxbckgdgonrqhxadcclbznjfdpzgegtgqawygxkgcjiasofqiecxvbdyageztjikvrxymqlapghcbcrtfgfdnhitjcaytqiknlsnwgrtbpfrlkwvvycraqicqnhpfrwbbizliasyfpawqqljslhqgktmccumgxmqlsemcvycsxovy'</span><br>	message=message.replace(<span class="hljs-string">" "</span>, <span class="hljs-string">""</span>) <span class="hljs-comment">#清除输入中的空格</span><br>	<span class="hljs-comment">#print(message)</span><br>	<span class="hljs-comment">#print(getLenKey(message))</span><br>	s=getKey(message.upper())<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">'密钥为：%s'</span>%s)<br>	t=decrypt(s,message.upper())<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">'解密结果为：%s'</span>%t)<br><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>	main()<br><br><br></code></pre></td></tr></table></figure>
<p>运行结果：</p>
<p><img src="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210021656478.png" srcset="/img/loading.gif" lazyload alt="image-20221002165614406"></p>
<h3 id="2-3字典攻击"><a href="#2-3字典攻击" class="headerlink" title="2.3字典攻击"></a>2.3字典攻击</h3><h4 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> detectEnglish,wordninja<br><br>Letters=<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">key,message</span>):<br><br>	result=<span class="hljs-string">''</span><br>	l=<span class="hljs-built_in">len</span>(key)<br>	j=<span class="hljs-number">0</span><br><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> message:<br>		<span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> Letters:<br>			index=(Letters.find(i)-Letters.find(key[j]))%<span class="hljs-number">26</span><br>			j=(j+<span class="hljs-number">1</span>)%l<br>			result=result+Letters[index]<br>		<span class="hljs-keyword">else</span>:<br>			result=result+i<br><br>	text=<span class="hljs-string">' '</span>.join(wordninja.split(result))<br><br>	<span class="hljs-keyword">return</span> text<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Hack</span>(<span class="hljs-params">message</span>):<br><br>	fo=<span class="hljs-built_in">open</span>(<span class="hljs-string">'dictionary.txt'</span>,<span class="hljs-string">'r'</span>)<br>	words=fo.readlines()    <span class="hljs-comment">#返回一个字符串列表，每个字符串是文件的一行</span><br>	fo.close()<br><br>	<span class="hljs-comment">#开始爆破</span><br>	<span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> words:<br>		word=word.strip()<br>		st=decrypt(word,message)<br><br>		<span class="hljs-comment">#message=message.replace(" ", "") #清除输入中的空格</span><br>		<span class="hljs-comment">#print(st)</span><br>		<span class="hljs-keyword">if</span> detectEnglish.isEnglish(st,wordPercentage=<span class="hljs-number">40</span>):<br>			<span class="hljs-built_in">print</span>(<span class="hljs-string">"密钥可能为%s"</span>%word)<br>			<span class="hljs-built_in">print</span>(<span class="hljs-string">"对应明文可能为%s"</span>%st)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	message=<span class="hljs-string">'TzxisnzeccjxkgnfqlolmysbbqqIlxcz.'</span><br>	Hack(message.upper())<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>	main()<br></code></pre></td></tr></table></figure>
<h4 id="detectEnglish-py"><a href="#detectEnglish-py" class="headerlink" title="detectEnglish.py"></a>detectEnglish.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Detect English module</span><br><span class="hljs-comment"># http://inventwithpython.com/hacking (BSD Licensed)</span><br><br><span class="hljs-comment"># To use, type this code:</span><br><span class="hljs-comment">#   import detectEnglish</span><br><span class="hljs-comment">#   detectEnglish.isEnglish(someString) # returns True or False</span><br><span class="hljs-comment"># (There must be a "dictionary.txt" file in this directory with all English</span><br><span class="hljs-comment"># words in it, one word per line. You can download this from</span><br><span class="hljs-comment"># http://invpy.com/dictionary.txt)</span><br>UPPERLETTERS = <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span><br>LETTERS_AND_SPACE = UPPERLETTERS + UPPERLETTERS.lower() + <span class="hljs-string">' \t\n'</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">loadDictionary</span>():<br>    dictionaryFile = <span class="hljs-built_in">open</span>(<span class="hljs-string">'dictionary.txt'</span>)<br>    englishWords = {}<br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> dictionaryFile.read().split(<span class="hljs-string">'\n'</span>):<br>        englishWords[word] = <span class="hljs-literal">None</span><br>    dictionaryFile.close()<br>    <span class="hljs-keyword">return</span> englishWords<br><br>ENGLISH_WORDS = loadDictionary()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getEnglishCount</span>(<span class="hljs-params">message</span>):<br>    message = message.upper()<br>    message = removeNonLetters(message)<br>    possibleWords = message.split()<br><br>    <span class="hljs-keyword">if</span> possibleWords == []:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0.0</span> <span class="hljs-comment"># no words at all, so return 0.0</span><br><br>    matches = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> possibleWords:<br>        <span class="hljs-keyword">if</span> word <span class="hljs-keyword">in</span> ENGLISH_WORDS:<br>            matches += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">float</span>(matches) / <span class="hljs-built_in">len</span>(possibleWords)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">removeNonLetters</span>(<span class="hljs-params">message</span>):<br>    lettersOnly = []<br>    <span class="hljs-keyword">for</span> symbol <span class="hljs-keyword">in</span> message:<br>        <span class="hljs-keyword">if</span> symbol <span class="hljs-keyword">in</span> LETTERS_AND_SPACE:<br>            lettersOnly.append(symbol)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>.join(lettersOnly)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">isEnglish</span>(<span class="hljs-params">message, wordPercentage=<span class="hljs-number">20</span>, letterPercentage=<span class="hljs-number">85</span></span>):<br>    <span class="hljs-comment"># By default, 20% of the words must exist in the dictionary file, and</span><br>    <span class="hljs-comment"># 85% of all the characters in the message must be letters or spaces</span><br>    <span class="hljs-comment"># (not punctuation or numbers).</span><br>    wordsMatch = getEnglishCount(message) * <span class="hljs-number">100</span> &gt;= wordPercentage<br>    numLetters = <span class="hljs-built_in">len</span>(removeNonLetters(message))<br>    messageLettersPercentage = <span class="hljs-built_in">float</span>(numLetters) / <span class="hljs-built_in">len</span>(message) * <span class="hljs-number">100</span><br>    lettersMatch = messageLettersPercentage &gt;= letterPercentage<br>    <span class="hljs-keyword">return</span> wordsMatch <span class="hljs-keyword">and</span> lettersMatch<br></code></pre></td></tr></table></figure>
<h4 id="运行结果示例："><a href="#运行结果示例：" class="headerlink" title="运行结果示例："></a>运行结果示例：</h4><p><img src="https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210031643690.png" srcset="/img/loading.gif" lazyload alt="image-20221003164334599"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">#密码学</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>密码学编程之维吉尼亚解密</div>
      <div>http://example.com/post/密码学编程之维吉尼亚解密.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>c1ongyan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>October 2, 2022</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/post/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%BC%96%E7%A8%8B%E4%B9%8B%E5%B8%8C%E5%B0%94%E5%AF%86%E7%A0%81%E5%8A%A0%E8%A7%A3%E5%AF%86.html" title="密码学编程之希尔密码加解密">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">密码学编程之希尔密码加解密</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/post/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%BC%96%E7%A8%8B%E4%B9%8B%E4%BB%BF%E5%B0%84%E8%A7%A3%E5%AF%86.html" title="密码学编程之仿射解密">
                        <span class="hidden-mobile">密码学编程之仿射解密</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Table of Contents</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="//cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>

</body>
</html>
