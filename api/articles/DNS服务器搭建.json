{"title":"DNS服务器搭建","uid":"01ca28eb96d7745fdd5c9dac85925e71","slug":"DNS服务器搭建","date":"2022-06-18T08:48:45.000Z","updated":"2022-11-29T12:52:02.107Z","comments":true,"path":"api/articles/DNS服务器搭建.json","keywords":null,"cover":[],"content":"<h3 id=\"DNS服务安装：\"><a href=\"#DNS服务安装：\" class=\"headerlink\" title=\"DNS服务安装：\"></a>DNS服务安装：</h3><p>DNS是一种协议，dns服务是依托bind软件实现的</p>\n<pre class=\"line-numbers language-linux\" data-language=\"linux\"><code class=\"language-linux\">apt-get install bind9</code></pre>\n<p>若无法下载，可尝试：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">apt-get update</code></pre>\n<h3 id=\"配置DNS服务：\"><a href=\"#配置DNS服务：\" class=\"headerlink\" title=\"配置DNS服务：\"></a>配置DNS服务：</h3><h4 id=\"1-主配置文件name-conf-local\"><a href=\"#1-主配置文件name-conf-local\" class=\"headerlink\" title=\"1.主配置文件name.conf.local\"></a>1.主配置文件name.conf.local</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">zone &quot;test.com&quot;  &#123;  #zone:区域设置；test.com:客户端请求的域名地址 \n    type master;                         &#x2F;&#x2F;正向解析：通过域名查找ip\n    file &quot;&#x2F;etc&#x2F;bind&#x2F;www.test.com&quot;; \n&#125;;\n\nzone &quot;0.168.192.in-addr.arpa&quot;&#123;\n    type master;                         &#x2F;&#x2F;反向解析：通过ip查找域名\n    file &quot;etc&#x2F;bind&#x2F;192.168.arpa&quot;;\n&#125;;</code></pre>\n<p>zone语句基本格式:(zone语句用于定义区域，其中必须说明域名、DNS服务器的类型和区域文件名等信息)</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">zone“域名”&#123;\n\n     type服务器类型;\n     file“区域文件名称”;\n     其他配置子句;&#125;;\n\n\ntype子句说明DNS服务器的类型。\n如果参数为master,  表明是主域名服务器;\n参数为slave,表明是辅助域名服务器;\n参数为hint,表明区域是根区域。</code></pre>\n<p>options语句基本格式：(options 语句定义服务器的全局配置选项)</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">options&#123;\n\n配置子句;&#125;;\n\n其中最常用的配置子句如下。\n</code></pre>\n<p>由于在域名系统中，一个IP地址可以对应多个域名，因此从IP出发去找域名，理论上应该遍历整个域名树，但这在Internet上是不现实的。为了完成逆向域名解析，系统提供一个特别域，该特别域称为逆向解析域in-addr.arpa。这样欲解析的IP地址就会被表达成一种像域名一样的可显示串形式，后缀以逆向解析域域<br>名”in-addr.arpa”结尾。<br>    例如一个IP地址：222.211.233.244，其逆向域名表达方式为：244.233.221.222.in-addr.arpa</p>\n<h4 id=\"2-正向区域文件\"><a href=\"#2-正向区域文件\" class=\"headerlink\" title=\"2.正向区域文件\"></a>2.正向区域文件</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">$TTL 604800\n@        IN   SOA    test.com.   admin.test.com. (&#x2F;&#x2F;SOA字段\n                     20040121         ;Serial        &#x2F;&#x2F;版本号    同步一次  +1\n                      604800          ;Refresh&#x2F;&#x2F;更新时间\n                       86400          ;Retry&#x2F;&#x2F; 更新失败，重试更新时间\n                      2419200         ;Expire&#x2F;&#x2F; 更新失败多长时间后此DNS失效时间\n                      604800 )         ;Negative Cache TTL&#x2F;&#x2F;解析不到请求不予回复时间\n\n@        IN    NS   www.test.com.         \n@        IN    A    192.168.0.112      \n@        IN    MX  10 mail.test.com.      &#x2F;&#x2F; 定义邮件服务器，10指优先级  0-99 数字越小优先级越高\nwww      IN    A    192.168.0.112   &#x2F;&#x2F;www.test.com的ip地址\nmail     IN    A    192.168.0.100   &#x2F;&#x2F;邮件服务器的ip地址</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$TTL 1D\n域名       IN SOA  主机名 管理员 电子邮件地址 (\n                                        0       ; serial  序列号\n                                        1D      ; refresh  刷新时间\n                                        1H      ; retry  重试时间\n                                        1W      ; expire  过期时间\n                                        3H )    ; minimum  最小时间\n        IN\tNS\t域名服务器\n区域名\tIN\tNS\t域名服务器\n主机名\tIN\tA\tIP 地址\n别名\tIN\tCNAME\t主机名\n区域名\tIN\tMX\t优先级\t邮件服务器\n</code></pre>\n<h4 id=\"3-反向区域文件\"><a href=\"#3-反向区域文件\" class=\"headerlink\" title=\"3.反向区域文件\"></a>3.反向区域文件</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">$TTL 604800\n@         IN   SOA    test.com.   admin.test.com. (\n                     20040121         ;Serial        &#x2F;&#x2F;版本号    同步一次  +1\n                      604800          ;Refresh&#x2F;&#x2F;更新时间\n                       86400          ;Retry&#x2F;&#x2F; 更新失败，重试更新时间\n                      2419200         ;Expire&#x2F;&#x2F; 更新失败多长时间后此DNS失效时间\n                      604800 )         ;Negative Cache TTL&#x2F;&#x2F;解析不到请求不予回复时间\n\n          IN   NS      www.test.com.\n112       IN   PTR     www.test.com.     &#x2F;&#x2F;反向解析PTR格式\n100       IN   PTR     mail.test.com.</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$TTL 1D\n域名       IN SOA  主机名 管理员 电子邮件地址 (\n                                        0       ; serial  序列号\n                                        1D      ; refresh  刷新时间\n                                        1H      ; retry  重试时间\n                                        1W      ; expire  过期时间\n                                        3H )    ; minimum  最小时间\n        IN\tNS\t域名服务器\nIP\t\tIN \tPTR\t主机名（域名）\n</code></pre>\n<h5 id=\"7、DNS资源记录：\"><a href=\"#7、DNS资源记录：\" class=\"headerlink\" title=\"7、DNS资源记录：\"></a>7、DNS资源记录：</h5><ol>\n<li><p><strong>SOA 资源记录(全区唯一)</strong></p>\n<p>每个区在区的开始处都包含了一个起始授权记录（Start of Authority Record）,简称SOA 记录.</p>\n<p>SOA 定义了域的全局参数,进行整个域的管理设置.一个区域文件只允许存在唯一的SOA 记录.</p>\n</li>\n<li><p><strong>NS 资源记录:</strong></p>\n<p>NS（Name Server）记录是域名服务器记录,用来指定该域名由哪个DNS服务器来进行解析.每个区在区根处至少包含一个NS 记录.</p>\n</li>\n<li><p><strong>A 资源记录</strong></p>\n<p>地址（A）资源记录把FQDN 映射到IP 地址. 因为有此记录,所以DNS服务器能解析FQDN域名对应的IP 地址.</p>\n<p>A ：是IPv4地址。 AAAA是IPv6主机地址。</p>\n</li>\n<li><p><strong>PTR 资源记录</strong></p>\n<p>相对于A 资源记录,指针（PTR）记录把IP地址映射到FQDN. 用于反向查询,通过IP地址,找到域名.</p>\n</li>\n<li><p><strong>CNAME 资源记录</strong></p>\n<p>别名记录（CNAME）资源记录创建特定FQDN 的别名.用户可以使用CNAME 记录来隐藏用户网络的实现细节,使连接的客户机无法知道真正的域名.</p>\n<p>例:ping百度时,解析到了百度的别名服务器.百度有个cname=<a href=\"http://www.a.shifen.com.xn--mcrt9bhy5d/\">www.a.shifen.com.的别名</a></p>\n</li>\n<li><p><strong>MX 资源记录</strong></p>\n<p>邮件交换（MX）资源记录,为DNS 域名指定邮件交换服务器.</p>\n<p>邮件交换服务器是为DNS 域名处理或转发邮件的主机.处理邮件指把邮件投递到目的地或转交另一不同类型的邮件传送者.转发邮件指把邮件发送到最终目的服务器,用简单邮件传输协议SMTP 把邮件发送给离最终目的地最近的邮件交换服务器,或使邮件经过一定时间的排队.</p>\n</li>\n</ol>\n<h3 id=\"启动DNS服务：\"><a href=\"#启动DNS服务：\" class=\"headerlink\" title=\"启动DNS服务：\"></a>启动DNS服务：</h3><p><strong>/etc/resolv.conf</strong>　　转换程序配置文件</p>\n<p>在配置程序请求BIND域名查询服务查询主机名时，必须告诉程序使用哪个域名服务器和IP地址来完成这个任务</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">vi &#x2F;etc&#x2F;resolv.conf</code></pre>\n<p><img src=\"C:\\Users\\hhh\\AppData\\Roaming\\Typora\\typora-user-images\\image-20220323213427942.png\" alt=\"image-20220323213427942\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">service named start  &#x2F;service bind9 start\nservice named status\nnetstat -anptul |grep 53\nnslookup</code></pre>\n<p>可能出现的问题:</p>\n<p><img src=\"C:\\Users\\hhh\\AppData\\Roaming\\Typora\\typora-user-images\\image-20220323005627124.png\" alt=\"image-20220323005627124\"></p>\n<p>参考链接:<a href=\"https://blog.csdn.net/qq_28513801/article/details/102537252\">https://blog.csdn.net/qq_28513801/article/details/102537252</a></p>\n<p>​                <a href=\"https://www.cnblogs.com/lidabo/p/15210887.html\">https://www.cnblogs.com/lidabo/p/15210887.html</a></p>\n<p>DNS攻击实例：</p>\n<p>1.</p>\n<p>解决方法：</p>\n<p>1.ERROR: Could not find a version that satisfies the requirement terminaltavles (from versions: none)</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">pip install 库包名 -i http:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F; --trusted-host pypi.douban.com</code></pre>\n<p><a href=\"https://blog.csdn.net/qq_45758854/article/details/115578939\">https://blog.csdn.net/qq_45758854/article/details/115578939</a></p>\n<p>2.ERROR:  Error installing xettercap-1.5.7xerob.gem:<br>        ERROR: Failed to build gem native extension.</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">apt-get install libpcap-dev \ngem install xettercap --pre\npython install.py </code></pre>\n","text":"DNS服务安装：DNS是一种协议，dns服务是依托bind软件实现的 apt-get install bind9 若无法下载，可尝试： apt-get update 配置DNS服务：1.主配置文件name.conf.localzone &quot;test.com&quot; &...","link":"","photos":[],"count_time":{"symbolsCount":"4.7k","symbolsTime":"4 mins."},"categories":[],"tags":[{"name":"DNS","slug":"DNS","count":1,"path":"api/tags/DNS.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#DNS%E6%9C%8D%E5%8A%A1%E5%AE%89%E8%A3%85%EF%BC%9A\"><span class=\"toc-text\">DNS服务安装：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AEDNS%E6%9C%8D%E5%8A%A1%EF%BC%9A\"><span class=\"toc-text\">配置DNS服务：</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-%E4%B8%BB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6name-conf-local\"><span class=\"toc-text\">1.主配置文件name.conf.local</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-%E6%AD%A3%E5%90%91%E5%8C%BA%E5%9F%9F%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">2.正向区域文件</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-%E5%8F%8D%E5%90%91%E5%8C%BA%E5%9F%9F%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">3.反向区域文件</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#7%E3%80%81DNS%E8%B5%84%E6%BA%90%E8%AE%B0%E5%BD%95%EF%BC%9A\"><span class=\"toc-text\">7、DNS资源记录：</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8DNS%E6%9C%8D%E5%8A%A1%EF%BC%9A\"><span class=\"toc-text\">启动DNS服务：</span></a></li></ol>","author":{"name":"c1ongyan","slug":"blog-author","avatar":"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210022256981.jpg","link":"/","description":"一个打算开始捣鼓的小白","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Hello World","uid":"b9663f58f18133b35bfe243f3e916a80","slug":"hello-world","date":"2022-07-27T17:32:29.616Z","updated":"2022-07-27T17:32:29.616Z","comments":true,"path":"api/articles/hello-world.json","keywords":null,"cover":null,"text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the ...","link":"","photos":[],"count_time":{"symbolsCount":436,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"c1ongyan","slug":"blog-author","avatar":"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210022256981.jpg","link":"/","description":"一个打算开始捣鼓的小白","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"马克思主义聊天室","uid":"9376667b68296aebfefe33aef15ebde9","slug":"马克思主义聊天室","date":"2021-11-25T02:54:54.000Z","updated":"2022-11-29T12:54:33.392Z","comments":true,"path":"api/articles/马克思主义聊天室.json","keywords":null,"cover":null,"text":"趣味马克思主义聊天室——马原结课趣味设计实现功能：趣味对话具体代码：package main import ( &quot;bufio&quot; &quot;fmt&quot; &quot;io&quot; &quot;math&#x2F;rand&quot; &quot;os...","link":"","photos":[],"count_time":{"symbolsCount":"60k","symbolsTime":"54 mins."},"categories":[],"tags":[{"name":"GO","slug":"GO","count":1,"path":"api/tags/GO.json"}],"author":{"name":"c1ongyan","slug":"blog-author","avatar":"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210022256981.jpg","link":"/","description":"一个打算开始捣鼓的小白","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}